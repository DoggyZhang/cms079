package com.msemu.commons.network.impl.crypt;

import com.msemu.commons.utils.HexUtils;

/**
 * Created by Weber on 2018/3/14.
 */
public class MapleEncryptionKey {

    private static final String[] secretKeys = new String[]{
            // 0
            "2923BE84E16CD6AE529049F1F1BBE9EBB3A6DB3C870C3E99245E0D1C06B747DE",
            // 1
            "B3124DC843BB8BA61F035A7D0938251F5DD4CBFC96F5453B130D890A1CDBAE32",
            // 2
            "888138616B681262F954D0E7711748780D92291D86299972DB741CFA4F37B8B5",
            // 3
            "209A50EE407836FD124932F69E7D49DCAD4F14F2444066D06BC430B7323BA122",
            // 4
            "F622919DE18B1FDAB0CA9902B9729D492C807EC599D5E980B2EAC9CC53BF67D6",
            // 5
            "BF14D67E2DDC8E6683EF574961FF698F61CDD11E9D9C167272E61DF0844F4A77",
            // 6
            "02D7E8392C53CBC9121E33749E0CF4D5D49FD4A4597E35CF3222F4CCCFD3902D",
            // 7
            "48D38F75E6D91D2AE5C0F72B788187440E5F5000D4618DBE7B0515073B33821F",
            // 8
            "187092DA6454CEB1853E6915F8466A0496730ED9162F6768D4F74A4AD0576876",
            // 9
            "5B628A8A8F275CF7E5874A3B329B614084C6C3B1A7304A10EE756F032F9E6AEF",
            // 10
            "762DD0C2C9CD68D4496A792508614014B13B6AA51128C18CD6A90B87978C2FF1",
            // 11
            "10509BC8814329288AF6E99E47A18148316CCDA49EDE81A38C9810FF9A43CDCF",
            // 12
            "5E4EE1309CFED9719FE2A5E20C9BB44765382A4689A982797A7678C263B126DF",
            // 13
            "DA296D3E62E0961234BF39A63F895EF16D0EE36C28A11E201DCBC2033F410784",
            // 14
            "0F1405651B2861C9C5E72C8E463608DCF3A88DFEBEF2EB71FFA0D03B75068C7E",
            // 15
            "8778734DD0BE82BEDBC246412B8CFA307F70F0A754863295AA5B68130BE6FCF5",
            // 16
            "CABE7D9F898A411BFDB84F68F6727B1499CDD30DF0443AB4A66653330BCBA110",
            // 17
            "5E4CEC034C73E605B4310EAAADCFD5B0CA27FFD89D144DF4792759427C9CC1F8",
            // 18
            "CD8C87202364B8A687954CB05A8D4E2D99E73DB160DEB180AD0841E96741A5D5",
            // 19
            "9FE4189F15420026FE4CD12104932FB38F735340438AAF7ECA6FD5CFD3A195CE"
    };

    public static byte[] getEncryptionKey(int serverVersion) {
        int pos = serverVersion - serverVersion / 20 * 20;
        byte[] skey = HexUtils.hex2Byte(secretKeys[pos]);
        byte[] finalKey = new byte[skey.length];
        for (int i = 0; i < finalKey.length; i += 4) {
            finalKey[i] = skey[i];
            finalKey[i + 1] = 0;
            finalKey[i + 2] = 0;
            finalKey[i + 3] = 0;
        }
        return finalKey;
    }

}
